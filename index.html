<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" type="image/x-icon" href="images/favicon.png">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi" crossorigin="anonymous">
    <link rel="stylesheet" href="index.css">
    <script>
        window.dataLayer = window.dataLayer || [];

        function gtag() {
            dataLayer.push(arguments);
        }

        if (localStorage.getItem('consentMode') === null) {
            gtag('consent', 'default', {
                'ad_storage': 'denied',
                'analytics_storage': 'denied',
                'personalization_storage': 'denied',
                'functionality_storage': 'denied',
                'security_storage': 'denied',
            });
        } else {
            gtag('consent', 'default', JSON.parse(localStorage.getItem('consentMode')));
        }

        if (localStorage.getItem('userId') != null) {
            window.dataLayer.push({
                'user_id': localStorage.getItem('userId')
            });
        }
    </script>
    <!-- Google Tag Manager -->
    <script>
        (function(w, d, s, l, i) {
            w[l] = w[l] || [];
            w[l].push({
                'gtm.start': new Date().getTime(),
                event: 'gtm.js'
            });
            var f = d.getElementsByTagName(s)[0],
                j = d.createElement(s),
                dl = l != 'dataLayer' ? '&l=' + l : '';
            j.async = true;
            j.src =
                'https://www.googletagmanager.com/gtm.js?id=' + i + dl;
            f.parentNode.insertBefore(j, f);
        })(window, document, 'script', 'dataLayer', 'GTM-KDK6WMPM');
    </script>
    <!-- End Google Tag Manager -->
    <title>Home | Google Analytics Tutorials</title>
</head>

<body>
    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KDK6WMPM" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->

    
<nav class="navbar navbar-expand-lg bg-primary navbar-dark">
    <div class="container-lg">
        <a class="navbar-brand" href="/">Google Analytics Tutorials</a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
                <li class="nav-item">
                    <a class="nav-link active" aria-current="page" href="/">Home</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="/about">About</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="/profile">Profile</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="/login">Login</a>
                </li>
            </ul>
        </div>
    </div>
</nav>
<main class="container-lg pt-3 pb-5">
    <h1 class="pt-4 pb-2">Hello Analytics!</h1>
    <a class="twitter-share-button" target="_blank" href="https://twitter.com/intent/tweet?text=%23HelloAnalytics%20%23GA4TutorialSeries">
        <span>Tweet</span></a>
    <div class="pt-4 content-width">
        <p>Welcome to the Google Analytics 4 Tutorial series!</p>
        <p>In the series, we will build out this website to show you how to use Google Analytics 4 to measure your
            website activity and performance. All of the code for the series can be found on the Google Analytics
            GitHub account.</p>
        <img src="google-analytics.jpg" />
        <p><span>Do you have any questions or topics that you'd like us to cover?</span> Please add your comments to
            one of the videos in the series, and we will aim to cover it in a future video.</p>
        <p>To learn more about this website and the series as a whole, check out <a href="/about">the About
                page</a>.</p>
    </div>
</main>

<footer class="bg-light pb-4 pt-4">
    <section class="pb-4 pt-4">
        <div class="container">
            <div class="row">
                <div class="col-md-6 mb-3">
                    <h6>Google Analytics</h6>
                    <p class="footer-description">Google Analytics is an enterprise-class web and app analytics
                        application used by marketers, advertisers, and site and app owners across the web and in mobile
                        apps.</p>
                    <div class="footer-description">
                        <a href="https://www.youtube.com/channel/UCJ5UyIAa5nEGksjcdp43Ixw" class="text-reset"
                            target="_blank">Videos</a>&emsp;
                        <a href="https://support.google.com/analytics" class="text-reset"
                            target="_blank">Support</a>&emsp;
                        <a href="https://github.com/googleanalytics" class="text-reset" target="_blank">GitHub</a>&emsp;
                        <a href="/about" class="text-reset">About</a>&emsp;
                        <a href="/newsletter" class="text-reset">Newsletter</a>
                    </div>
                </div>

                <div class="col-md-5 offset-md-1 mb-3">
                    <form id="newsletter-form-footer" action="/thank-you">
                        <h5>Subscribe to our newsletter</h5>
                        <p>This is a demo and does not save your email.</p>
                        <div class="d-flex flex-column flex-sm-row w-100 gap-2">
                            <label for="email" class="visually-hidden">Email address</label>
                            <input id="email" name="email" type="text" class="form-control" placeholder="Email address">
                            <button class="btn btn-primary" type="submit">Subscribe</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </section>
</footer>
    <div class="container-sm">
  <button class="btn btn-info" type="button" data-bs-toggle="collapse" data-bs-target="#debug-panel" aria-expanded="true" aria-controls="debug-panel">Toggle debug panel</button>
  <!-- Collapsible debug panel -->
  <div class="collapse" id="debug-panel">
      <button id="btn-fetch" class="btn btn-outline-primary">Fetch debug values</button>
      <button id="btn-clear" class="btn btn-outline-warning">Clear client and session</button>
      <br/>
      <label for="tag-id">GA4 Tag ID</label>
      <input type="text" class="form-control" id="tag-id" name="tag-id" disabled="true">
      <label for="session-id">GA4 Session ID</label>
      <input type="text" class="form-control" id="session-id" name="session-id" disabled="true">
      <label for="client-id">GA4 Client ID</label>
      <input type="text" class="form-control" id="client-id" name="client-id" disabled="true">
      <label for="user-id">GA4 User ID</label>
      <input type="text" class="form-control" id="user-id" name="user-id" disabled="true">
  </div>
</div>

<script>
  // Function for populating the debug panel values.
  function setIds() {
    // TODO: This may not be a reliable solution. From:
    //       https://stackoverflow.com/questions/76075126/given-gtm-installed-ga4-how-to-send-events-via-gtag-without-send-to
    var gtagIds = Object.keys( window.google_tag_manager || [] ).filter( e => { return e.substring(0,2) == 'G-' } );
    if (gtagIds) {
      // Uses the first tag ID found.
      const firstTagId = gtagIds[0];

      // Gets each field that will be updated.
      const tagIdField = document.getElementById('tag-id');
      const sessionIdField = document.getElementById('session-id');
      const clientIdField = document.getElementById('client-id');
      const userIdField = document.getElementById('user-id');

      Promise.all([
        firstTagId,
        localStorage.getItem('userId'),
        // Gets values from gtag.
        // See https://developers.google.com/tag-platform/gtagjs/reference#set_examples.
        new Promise(cid => gtag('get', firstTagId, 'client_id', cid)),
        new Promise(sid => gtag('get', firstTagId, 'session_id', sid)),
      ]).then(([tagId, userId, clientId, sessionId]) => {
        // Updates value for each field.
        tagIdField.value = tagId;
        userIdField.value = userId;
        clientIdField.value = clientId;
        sessionIdField.value = sessionId;

        // Logs info as an object.
        console.log(JSON.stringify(
          {
            "user_id": userIdField.value,
            "client_id": clientId,
            "session_id": sessionId,
          },
          null,
          '  '));
      });
    }
  }
  document.getElementById('btn-fetch').addEventListener("click", setIds);

  // Function for clearing the GA cookies.
  function clearCookies() {
    document.cookie.split('; ').map(c => c.split('=')[0]).forEach(
      name => document.cookie = name + '=; expires=Thu, 01 Jan 1970 00:00:01 GMT;');
    // Reloads the page.
    location.reload();
  }
  document.getElementById('btn-clear').addEventListener("click", clearCookies);

  // Populates the debug panel when shown.
  document.getElementById('debug-panel').addEventListener('shown.bs.collapse', event =>
    setIds());
</script>

    <div id="cookie-consent-banner" class="cookie-consent-banner">
    <h3>Cookie settings</h3>
    <p>We use cookies to provide you with the best possible experience. They also allow us to analyze user behavior in order to constantly improve the website for you.</p>
    <button id="btn-accept-all" class="cookie-consent-button btn-success">Accept All</button>
    <button id="btn-accept-some" class="cookie-consent-button btn-outline">Accept Selection</button>
    <button id="btn-reject-all" class="cookie-consent-button btn-grayscale">Reject All</button>
    <div class="cookie-consent-options">
        <label><input id="consent-necessary" type="checkbox" value="Necessary" checked disabled>Necessary</label>
        <label><input id="consent-analytics" type="checkbox" value="Analytics" checked>Analytics</label>
        <label><input id="consent-preferences" type="checkbox" value="Preferences" checked>Preferences</label>
        <label><input id="consent-marketing" type="checkbox" value="Marketing">Marketing</label>
    </div>
</div>

<script>
    function hideBanner() {
        document.getElementById('cookie-consent-banner').style.display = 'none';
    }

    if (localStorage.getItem('consentMode') === null) {

        document.getElementById('btn-accept-all').addEventListener('click', function() {
            setConsent({
                necessary: true,
                analytics: true,
                preferences: true,
                marketing: true
            });
            hideBanner();
        });
        document.getElementById('btn-accept-some').addEventListener('click', function() {
            setConsent({
                necessary: true,
                analytics: document.getElementById('consent-analytics').checked,
                preferences: document.getElementById('consent-preferences').checked,
                marketing: document.getElementById('consent-marketing').checked
            });
            hideBanner();
        });
        document.getElementById('btn-reject-all').addEventListener('click', function() {
            setConsent({
                necessary: false,
                analytics: false,
                preferences: false,
                marketing: false
            });
            hideBanner();
        });
        document.getElementById('cookie-consent-banner').style.display = 'block';
    }

    function setConsent(consent) {
        const consentMode = {
            'functionality_storage': consent.necessary ? 'granted' : 'denied',
            'security_storage': consent.necessary ? 'granted' : 'denied',
            'ad_storage': consent.marketing ? 'granted' : 'denied',
            'analytics_storage': consent.analytics ? 'granted' : 'denied',
            'personalization_storage': consent.preferences ? 'granted' : 'denied',
        };
        gtag('consent', 'update', consentMode);
        localStorage.setItem('consentMode', JSON.stringify(consentMode));
    }
</script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-OERcA2EqjJCMA+/3y+gxIOqMEjwtxJY7qPCqsdltbNJuaOe923+mo//f6V8Qbsw3" crossorigin="anonymous"></script>
</body>

</html>
